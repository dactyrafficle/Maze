<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="a.css">
  <link rel="icon" href="a.png">
</head>
<body>
 
  <div class='box'>
    <div class='box'>
     
     <!--
      <button id='reset_button'>RESET</button>
      <button id='pause_button'>PAUSE</button>
      -->
      
      <button id='step_into_button'>STEP INTO</button>
      
      <div class='status'>
        <div id='pause_status' class='green'>LIVE</div>
      </div>
  
  
  <!--
        <table class='mytables'>
          <tr>
            <td><div>-00.00</div></td>
            <td><div>-00.00</div></td>
          </tr>
          <tr>
            <td><div>y</div></td>
            <td><div>x</div></td>
          </tr>
          <tr>
            <td><div id='y_coordinate'>00.00</div></td>
            <td><div id='x_coordinate'>00.00</div></td>
          </tr>

          <tr><td colspan=2></td></tr>
          <tr><td colspan=2>frame count</td></tr>
          <tr><td colspan=2><div id='frame_count'>0</div></td></tr>

          <tr><td colspan=2></td></tr>
          <tr>
            <td><div>fps</div></td>
            <td><input id='frames_per_second' type='number' min=0 max=30 step=1 /></td>
          </tr>

          <tr><td colspan=2></td></tr>
          <tr><td colspan=2>active cell</td></tr>
          <tr>
            <td><div>y</div></td>
            <td><div>x</div></td>
          </tr>
          <tr>
            <td>
              <div id='active_cell_y'>0</div>
            </td>
            <td>
              <div id='active_cell_x'>0</div>
           </td>
          </tr>
      </table> -->
     
      <div id='infobox_container'></div>
     
    </div>
  </div>
  <div class='box'>
    <div id='container'></div>
  </div>

</body>

 
<script src='Box.js'></script>

<script src='Cell.js'></script>
<script src='Corner.js'></script>
<script src='Edge.js'></script>
 

<script src='Maze.js'></script>
<script src='setup.js'></script>
 
<script>

// make a maze, like tetris blocks
// place them, until end
// fill in gaps, as tetris

 
// animation globals

let container;

 /*
let TIMER_FPS;
let FRAME_COUNT = 0;
let FRAME_INTERVAL = 1000;
let PAUSE = false;
let ANIMATION;
*/

// infobox globals

let reset_button, pause_button;
let pause_status;
 
let coordinates_box;
let x_coordinate, y_coordinate;
let active_cell_y, active_cell_x;

let step_into_button;
let infobox_container;

window.onload = function() {

  container = document.getElementById('container');
  container.appendChild(maze.c);
  
  infobox_container = document.getElementById('infobox_container');
  infobox_container.appendChild(maze.INITIALIZE_INFOBOX());
  
  maze.ANALYZE_NEIGHBORS(); // if done, returns nothing
  maze.SHOW_ANALYSIS();
  maze.REDRAW();

  // STEP INTO
  step_into_button = document.getElementById('step_into_button');
  step_into_button.addEventListener('click', function() {
    
    if (maze.CURRENT.STATE.END) {
    
    
      console.log(Math.random());
      /*
      maze.MAKE_WALLS();
      
      maze.RESET_MAZE();
      maze.INITIALIZE();
      
      maze.ANALYZE_NEIGHBORS();
      maze.SHOW_ANALYSIS();
      maze.REDRAW();
      */
      
      n++;
      if (n >= 12) {
        n = 4;
      }

      maze.RESET_MAZE2(n, n);
      maze.CREATE_CELLS();
      maze.INITIALIZE();

      maze.CREATE_CORNERS();
      maze.CREATE_EDGES();

      maze.MAKE_WALLS();
      maze.GET_CELL_NEIGHBORS();
      
      
      maze.ANALYZE_NEIGHBORS(); // if done, returns nothing
      maze.SHOW_ANALYSIS();
      maze.REDRAW();
      
      


    } else {

      maze.MOVE_TO_NEW_ACTIVE_CELL();
      
      maze.ANALYZE_NEIGHBORS();
      maze.SHOW_ANALYSIS();
      maze.REDRAW();
    }

    
    
    
  });

} // CLOSING window.onload


 /*
 
  reset_button = document.getElementById('reset_button');
  pause_button = document.getElementById('pause_button');
  pause_status = document.getElementById('pause_status');
 
  frame_count = document.getElementById('frame_count');
  frames_per_second = document.getElementById('frames_per_second');

  TIMER_FPS = 4;
  FRAME_INTERVAL = 1000 / TIMER_FPS;
  frames_per_second.value = TIMER_FPS;

 
 
  coordinates_box = document.getElementById('coordinates_box');
  x_coordinate = document.getElementById('x_coordinate');
  y_coordinate = document.getElementById('y_coordinate');
 
  active_cell_x = document.getElementById('active_cell_x');
  active_cell_y = document.getElementById('active_cell_y');
  */
 
  /*
  pause_button.addEventListener('click', function() {
    if (PAUSE === false) {
      PAUSE = true;
      pause_status.innerHTML = 'PAUSED';
      pause_status.classList.remove('green');
      pause_status.classList.add('red');
    } else {
      PAUSE = false;
      pause_status.innerHTML = 'LIVE';
      pause_status.classList.add('green');
      pause_status.classList.remove('red');
    }
  });
  
 
  container.addEventListener('mousemove', function(e) {
   
    let rect = this.getBoundingClientRect();
    let pixel = {
      'x':e.clientX - rect.left,
      'y':e.clientY - rect.top
    };    
    let val = b.PIXEL2VAL(pixel);
  });    
 */
  /*
    x_coordinate.innerHTML = (val.x).toFixed(2);
    y_coordinate.innerHTML = (val.y).toFixed(2);
   
    for (let i = 0; i < edges.length; i++) {
      let dx = Math.abs(val.x - edges[i].cx);
      let dy = Math.abs(val.y - edges[i].cy);
      let r = (dx**2 + dy**2)**0.5;
     
      if (r < 0.25) {
        edges[i].HIGHLIGHT();
      } else {
        edges[i].DEHIGHLIGHT();
      }
     
    }
   
   
  container.addEventListener('click', function(e) {
   
    let rect = this.getBoundingClientRect();
    let pixel = {
      'x':e.clientX - rect.left,
      'y':e.clientY - rect.top
    };
    let val = b.PIXEL2VAL(pixel);
  });
 
  reset_button.addEventListener('click', function() {
   
    for (let y = 0; y < steps.length; y++) {
      for (let x = 0; x < steps[y].length; x++) {
        steps[y][x].RESET();
      }
    }
    FRAME_COUNT = 0;
    frame_count.innerHTML = 0;
   
    // RESET THE FIRST STEP
    active_step = steps[0][0];
    active_step.ACTIVATE();  
    active_step.DEAD_END = true;    
   
    // REDRAW
    DRAW_IT(b);
  });
 
 

  ANIMATION = window.setInterval(function() {
   
    // INITIALIZE
    if (FRAME_COUNT === 0) {
      // ignore
    }
   
    if (FRAME_COUNT > 0) {
      maze.CHOOSE_NEW_ACTIVE_CELL();
    }
   
    DRAW_IT(b, maze);
   
   
   
    FRAME_COUNT++;
    console.log(FRAME_COUNT);
  }, FRAME_INTERVAL*8);  // CLOSING animation
 
    */                                    
                                     

 

function DRAW_IT(b, maze) {



  // DRAW THE CORNERS
  Object.keys(maze.corners).forEach(function(a) {
    b.POINT(maze.corners[a]);
  });

  // DRAW THE EDGES

 


}
 

</script>
